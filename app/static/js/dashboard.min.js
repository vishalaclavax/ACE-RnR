var activityProcessing,activityPage=2,activityPageSize=15,actScrollPos=0;function cancel_comment(e,t){$("#addComment_"+t).hide(),$("#commentBox_"+t).siblings(".custom_error").html(""),$("#commentBox_"+t).val("")}function submit_post_comment(e,t){var o=$("#commentBox_"+t).val(),a=($("#transactionId_"+t).val(),$("#commentFrm_"+t).serialize());""!=o.trim()?($(e).closest(".comment_frm").find("p.custom_error").html(""),$.ajax({url:app_base_url+"save-user-comment",type:"post",dataType:"json",cache:!1,data:a,beforeSend:function(){$(".loaderbox").show()},success:function(e){if($(".loaderbox").hide(),console.log(e),0==e.error){if(e.data.img)var t=e.data.img;else t="/static/img/user.png";$("#addComment_"+e.form_index).hide(),$("#tblCommentBox_"+e.form_index).prepend('<li class="commentBox"><div class="commentBox_img"><img src="'+t+'" width="40"/></div><div class="commentBox_contant"><p><strong>'+e.data.name+'</strong> <span class="block">'+e.data.comment+"</span></p><p>"+e.data.date_time+"</p></div></li>"),$("#commentBox_"+e.form_index).siblings(".custom_error").html(""),$("#commentBox_"+e.form_index).val("");try{socket.emit("activity response",{data:"From comment socket!"})}catch(e){console.log("exception from comment: "+e)}}else e.fields_error.comment?$("#commentBox_"+e.form_index).siblings(".custom_error").html(e.fields_error.comment):$("#commentBox_"+e.form_index).siblings(".custom_error").html(""),e.fields_error.comment||($("#commentBox_"+e.form_index+".message").html('<div class="alert alert-danger">'+e.msg+"</div>"),window.setTimeout(function(){$("#commentBox_"+e.form_index+".message").html("")},2e3))},complete:function(){}})):$(e).closest(".comment_frm").find("p.custom_error").html("Comment is required!")}function submit_user_like(e,t,o,a,s,i,n,l,r,c,d,m,_){console.log("inside like---------");d=d,m=m;var p=[];console.log(typeof _),console.log(_);var g=JSON.parse(_);if("false"==t.toLowerCase()?is_liked=!0:is_liked=!1,data={is_liked:is_liked,transaction_id:o,form_index:a,ttl_like:s,receiver_name:i,receiver_email:n,awarded_by_name:l,awarded_by_email:r,method_type:c},1==is_liked)var u="/static/img/like_icon_filled.png";else u="/static/img/like_icon.png";s=parseInt(s);var f=0,v="";if(1==is_liked?(f=s=parseInt(s)+1,like_data={name:d,email:m},g.push(like_data),$.each(g,function(e,t){if(t.name)var o=t.name;else o=t.email;new_obj={name:t.name,email:t.email},p.push(new_obj),v+='<li data-email="'+t.email+'"><span title="'+t.email+'">'+o+"</span></li>"})):(f=s=parseInt(s)-1,(s<=0||isNaN(s))&&(f=""),console.log("i m outside"),g&&(console.log("i m hereeeeeeeeeeeeee"),console.log(g),console.log(p),$.each(g,function(e,t){if(t.name)var o=t.name;else o=t.email;t.email!=m&&(v+='<li data-email="'+t.email+'"><span title="'+t.email+'">'+o+"</span></li>",p.push({name:t.name,email:t.email}))}))),s>0)var b=s;else b=0;var h="";v&&(h='<div class="likedCustomers" id="likedCustomers_'+a+'"><ul>'+v+"</ul></div>");var x=JSON.parse(JSON.stringify(p)),y=JSON.stringify(x);y=y.replace(/\"/g,"&quot;"),$("#likeBoxSection_"+a).html('<a href="javascript:void(0)" class="like_btn" onclick="submit_user_like(this,\''+is_liked+"','"+o+"','"+a+"', '"+b+"', '"+i+"', '"+n+"', '"+l+"', '"+r+"', '"+c+"','"+d+"','"+m+"','"+y+'\')" id="likeBox_'+a+'"><img src="'+u+'" class="likeitbefore"/>Like <small class="ttl_like">'+f+"</small></a>"+h),$.ajax({url:app_base_url+"save-user-like",type:"post",dataType:"json",cache:!1,headers:{"X-CSRFToken":csrf_token},data:data,beforeSend:function(){},success:function(e){if(console.log(e),0==e.error){if("true"==e.is_liked);else;if("true"==e.is_liked);else;var t=0;if("true"==e.is_liked&&e.ttl_like?t=parseInt(e.ttl_like)+1:(t=parseInt(e.ttl_like)-1,(t<=0||isNaN(t))&&""),t>0);else;try{socket.emit("activity response",{data:"From like socket!"})}catch(e){console.log("exception from like: "+e)}}},complete:function(){}})}function load_more_comment(e){!0===$("#tblCommentBox_"+e).find(".show_rows").is(":visible")?($("#tblCommentBox_"+e).find(".show_rows").hide(),$("#show_more_less_"+e).text("Show More...")):($("#tblCommentBox_"+e).find(".show_rows").show(),$("#show_more_less_"+e).text("Show Less..."))}function loadMoreActivity(){$.ajax({url:app_base_url+"load-more-activity",type:"post",dataType:"json",cache:!1,data:{page:activityPage,page_size:activityPageSize},beforeSend:function(){$("#loadActivityBtn").prop("disabled",!0),$("#loadActivityBtn").text("Loading Please Wait...")},success:function(e){$("#loadActivityBtn").prop("disabled",!1),$("#loadActivityBtn").removeProp("disabled"),$("#loadActivityBtn").text("Load More"),0==e.error&&e.activity_data&&($("#activitySection").append(e.activity_data),activityPage+=1)}})}function delete_post_an_update(e){if(!confirm("Do you want delete this post?"))return!1;$.ajax({url:app_base_url+"delete-post-an-update",type:"post",dataType:"json",cache:!1,data:{transactionid:e},beforeSend:function(){$(".loaderbox").show()},success:function(e){if($(".loaderbox").hide(),0==e.error){$.growl.notice({title:"Post an Update ",message:e.msg,size:"large"});try{socket.emit("activity response",{data:"From delete post socket!"})}catch(e){console.log("exception from comment: "+e)}}else $.growl.error({title:"Post an Update ",message:e.msg,size:"large"})}})}function read_more_announcement(e,t,o,a,s){var i=$("#postDesc_"+o).val(),n="/static/img/user.png";if(""!=$("#postUserImg_"+o).val()&&"none"!=$("#postUserImg_"+o).val().toLowerCase())n=$("#postUserImg_"+o).val();if("Post & Announcement"!=s)if("Post"==s)i="<strong>"+$("#userAwarded_"+o).val()+"</strong> has been celebrated/recognized <strong>"+$("#rewardId_"+o).val()+"</strong>";else i="<strong>"+$("#userAwarded_"+o).val()+"</strong> has been rewarded <strong>"+$("#rewardId_"+o).val()+"</strong>";var l='<strong>By:</strong> <img src="'+n+'" class="img-fluid" width="50" /> '+t;$("#readMoreModal #exampleModalLabel").html(e),$("#readMoreModal #post").html(i),$("#readMoreModal #post_by").html(l),$("#readMoreModal #post_date").html("<strong>Date:</strong> "+a),$("#readMoreModal").modal("show")}function toggle_announcement(e){$(".show_announcement_content_box").is(":visible")?($(".show_announcement_content_box").hide(),$(e).text("View All")):($(".show_announcement_content_box").show(),$(e).text("View Less"))}function toggle_leaderboard(e){$(".toggle_leaderboard_data").is(":visible")?($(".toggle_leaderboard_data").css("display","none"),$(e).text("View All")):($(".toggle_leaderboard_data").css("display","flex"),$(e).text("View Less"))}function toggle_top_receiver(e){$(".toggle_top_receiver").is(":visible")?($(".toggle_top_receiver").css("display","none"),$(e).text("View All")):($(".toggle_top_receiver").css("display","flex"),$(e).text("View Less"))}function toggle_top_giver(e){$(".toggle_top_giver").is(":visible")?($(".toggle_top_giver").css("display","none"),$(e).text("View All")):($(".toggle_top_giver").css("display","flex"),$(e).text("View Less"))}function toggle_bday(e){$(".toggle_bday_data").is(":visible")?($(".toggle_bday_data").css("display","none"),$(e).text("View All")):($(".toggle_bday_data").css("display","flex"),$(e).text("View Less"))}function toggle_anniversary_data(e){$(".toggle_anniversary_data").is(":visible")?($(".toggle_anniversary_data").css("display","none"),$(e).text("View All")):($(".toggle_anniversary_data").css("display","flex"),$(e).text("View Less"))}function delete_comment(e){if(console.log(e),!confirm("Do you want to delete this comment?"))return!1;$.ajax({url:app_base_url+"delete-comment?id="+e,type:"get",dataType:"json",cache:!1,data:{id:e},beforeSend:function(){$(".loaderbox").show()},success:function(e){if($(".loaderbox").hide(),console.log(e),console.log("response"),0==e.error){$.growl.notice({title:"Delete a comment ",message:e.message,size:"large"});try{socket.emit("activity response",{data:"From delete comment socket!"})}catch(e){console.log("exception from comment: "+e)}window.setTimeout(function(){window.location.reload()},1e3)}else $.growl.error({title:"Post a comment ",message:e.message,size:"large"})}})}$(document).ready(function(){$("#receivegivetabs li:first-child").addClass("active"),$(".rgvtab-content").hide(),$(".rgvtab-content:first").show(),$("#receivegivetabs li").click(function(){$("#receivegivetabs li").removeClass("active"),$(this).addClass("active"),$(".rgvtab-content").hide();var e=$(this).find("a").attr("href");return $(e).fadeIn(),!1}),$(document).on("click",".comment_btn",function(){$(this).closest("div").next(".add_comment").toggle()}),$(".popup_btn").click(function(e){$(".postanupdatebox").fadeIn(500),e.preventDefault()}),$(".popup_close").click(function(e){$(".postanupdatebox").fadeOut(500),e.preventDefault()}),$(".readMoreButton").on("click",function(){var e=$(".post",this).val(),t=($(".imgURL",this).val(),$(".heading",this).val());$("#post").text(e),$("#exampleModalLabel").text(t)}),$("#postAnUpdateFrm").validate({errorElement:"p",ignore:[],rules:{post_desc:{required:!0}},messages:{post_desc:{required:"Description is required!"}},errorPlacement:function(e,t){t.hasClass("reg_password")?e.insertAfter(t.next(".showpassword")):t.hasClass("reg_email")?e.insertAfter(t.next(".verifynumber")):e.insertAfter(t)},submitHandler:function(){$.ajax({url:app_base_url+"post-an-update",type:"post",contentType:!1,processData:!1,cache:!1,enctype:"multipart/form-data",data:new FormData($("#postAnUpdateFrm")[0]),beforeSend:function(){$(".loaderbox").show(),$("#submitPost").prop("disabled",!0)},success:function(e){$(".loaderbox").hide(),$("#submitPost").prop("disabled",!1),$("#submitPost").removeProp("disabled"),console.log(e),$(".postanupdatebox").hide();try{socket.emit("activity response",{data:"From delete post socket!"})}catch(e){console.log("exception from comment: "+e)}},complete:function(){$(".loaderbox").hide()}})}})});