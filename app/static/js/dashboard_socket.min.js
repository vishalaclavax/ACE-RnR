socket.on("activity response",(function(e){activity_data=e.data;var a=e.usr_name,t=e.usr_email,i="";$(".loaderbox").hide(),activity_data?($.each(activity_data,(function(e,n){var s="",o="",m="",d="",c="",r="",l="",_="",p="",v="",u="",g="",h="",y="",b=!1,f=[];if(f=JSON.stringify(f),e+=1,n.postLikeUsers&&(f=(f=JSON.stringify(n.postLikeUsers)).replace(/\"/g,"&quot;"),$.each(n.postLikeUsers,(function(e,a){if(a.email==session_user&&(b=!0),a.name)var t=a.name;else t=a.email;h+='<li data-email="'+a.email+'"><span title="'+a.email+'">'+t+"</span></li>"}))),""!=h&&(y='<div class="likedCustomers" id="likedCustomers_'+e+'"><ul>'+h+"</ul></div>"),v=b?"/static/img/like_icon_filled.png":"/static/img/like_icon.png",""!=n.totalLikes&&parseInt(n.totalLikes)>0&&(u='<small class="ttl_like">'+n.totalLikes+"</small>"),n.transactionData.transaction_date&&(transaction_date=n.transactionData.transaction_date,m=getLocalDate(transaction_date,"dd-mm-yyyy","ampm")),$("#addComment_"+e)&&$("#addComment_"+e).is(":visible"))var w="display:block;";else w="display:none;";if(n.postComment&&($.each(n.postComment,(function(e,a){var t="",i="/static/img/user.png";if((e+=1)>4)var s="show_rows";else s="";if(a.profileimage)i=a.profileimage;a.commenteddate&&(cmt_transaction_date=a.commenteddate,t=getLocalDate(transaction_date,"dd-mm-yyyy","ampm")),n.transactionData.email!=a.email&&"True"!=is_hr||(p='<span class="deleteComment" onclick="delete_comment(\''+a.id+'\')" title="Delete the comment"><img src="/static/img/delete.png" /></span>'),g+='<li class="commentBox '+s+'" style=""><div class="commentBox_img"><img src="'+i+'"></div><div class="commentBox_contant"><p><strong>'+a.Emp_Name+'</strong><span class="block">'+a.comment+"</span></p><p><span>"+t+"</span>"+p+"</p></div></li>"})),n.postComment.length>4&&(g+='<li class="commentBox show_more_btn"><div class="commentBox_contant loadmore_"><a href="javascript:void(0)" onclick="load_more_comment('+e+')" id="show_more_less_'+e+'">Show More...</a></div></li>')),"Post & Announcement"==n.transactionData.transactionmethodkey){if(d=n.customer.Emp_Name,c=n.transactionData.heading,_=n.transactionId,n.customer.profileimage)s=n.customer.profileimage;else s="/static/img/user.png";if(o=n.transactionData.post?n.transactionData.post:"",!n.awardImage&&n.transactionData.imgURL){var k=(r=n.transactionData.imgURL).split(".");l="pdf"!=k[k.length-1]?'<div class="update_image_box"><img src="'+r+'" class="img-fluid" /></div>':'<div class="update_image_box"><iframe src="https://drive.google.com/viewerng/viewer?embedded=true&url='+r+'" width="400px" height="400px" style="border: none"></iframe></div>'}n.transactionData.email!=session_user&&"True"!=is_hr||(p='<a href="javascript:void(0)" class="removeActivity" onclick="delete_post_an_update(\''+_+'\')" title="Delete the Post"><img src="/static/img/delete.png" /></a>'),i+='<div class="updates_box"><div class="row update_header_row"><div class="col-xl-12"><div class="updater_header"><div class="updater_header-top">'+p+'<h4><img src="'+s+'" class="img-fluid"><strong>'+d+"</strong> has posted an update <strong>"+c+'</strong></h4></div><div class="updater_header-bottom"><p>'+o+'</p><p class="award_date">'+m+"</p></div></div></div></div>"+l+'<div class="updatefooter"><ul><li id="likeBoxSection_'+e+'"><a href="javascript:void(0)" class="like_btn" onclick="submit_user_like(this,\''+b+"','"+_+"','"+e+"','"+n.totalLikes+"', '"+d+"', '"+n.transactionData.email+"', '"+n.customer.awarded_by_name+"', '"+n.transactionData.awarded_by_email+"', '"+n.transactionData.transactionmethodkey+"', '"+a+"','"+t+"','"+f+'\')" id="likeBox_'+e+'"><img src="'+v+'" class="likeitbefore">Like '+u+"</a>"+y+'</li><li><a href="javascript:void(0)" class="comment_btn" id="show_comment_box"><img src="/static/img/reply_icon.png">Comment</a></li></ul></div><div class="add_comment" id="addComment_'+e+'" style="'+w+'"><form class="comment_frm" id="commentFrm_'+e+'" name="comment_frm" method="post"><div class="message"></div><input type="hidden" name="csrf_token" value="+csrf_token+"><input type="hidden" name="form_index" id="formIndex_'+e+'" value="'+e+'"><input type="hidden" name="transaction_id" id="transactionId_'+e+'" value="'+_+'"><input type="hidden" name="comment_receiver_name" id="commentReceiverName_'+e+'" value="'+n.customer.Emp_Name+'"><input type="hidden" name="comment_receiver_email" id="commentReceiverEmail_'+e+'" value="'+n.transactionData.email+'"><input type="hidden" name="comment_awarded_by_name" id="commentAwardedByName_'+e+'" value="'+n.customer.awarded_by_name+'"><input type="hidden" name="comment_awarded_by_email" id="commentAwardedByEmail_'+e+'" value="'+n.transactionData.awarded_by_email+'"><input type="hidden" name="comment_method_type" id="commentMethodType_'+e+'" value="'+n.transactionData.transactionmethodkey+'"><textarea rows="2" name="comment_box" id="commentBox_'+e+'" placeholder="Enter Comment"></textarea><p class="custom_error"></p><div class="post_btn_box"><button type="button" class="cancel_comment" id="cancelComment_'+e+'" onclick="cancel_comment(this,\''+e+'\')">Cancel</button>&nbsp;&nbsp;<button class="submit_comment" type="button" id="submitComment_1" onclick="submit_post_comment(this,\''+e+'\')">Post</button></div></form></div><div class="comment_list_box"><ul id="tblCommentBox_'+e+'">'+g+"</ul></div></div>"}else{var x="";if("nominate"==n.transactionData.Reward_Cat.toLowerCase()?activity_txt="rewarded":activity_txt="celebrated/recognized","nominate"!=n.transactionData.Reward_Cat.toLowerCase()&&n.transactionData.award_values)var D='<span class="block">NPCI Way Tenet Exhibited - <strong>'+n.transactionData.award_values+"</strong></span>";else D="";if(n.customer.profileimage)var C=n.customer.profileimage;else C="/static/img/user.png";if(n.customer.awarded_by_image)var B=n.customer.awarded_by_image;else B="/static/img/user.png";n.awardImage&&(x='<div class="update_image_box"><img src="'+n.awardImage+'" class="img-fluid"></div>'),i+='<div class="updates_box"><div class="row update_header_row"><div class="col-xl-12"><div class="updater_header"><div class="updater_header-top"><h4><img src="'+C+'" class="img-fluid"><strong>'+n.customer.Emp_Name+" </strong> has been "+activity_txt+" <strong>"+n.transactionData.reward_id+'</strong> by <strong class="profileBox">'+n.customer.awarded_by_name+'<img src="'+B+'" class="recognizer_img"></strong>'+D+'</h4></div><div class="updater_header-bottom"><p>'+n.transactionData.citation_msg+'</p><p class="award_date">'+m+"</p></div></div></div></div>"+x+'<div class="updatefooter"><ul><li id="likeBoxSection_'+e+'"><a href="javascript:void(0)" class="like_btn" onclick="submit_user_like(this,\''+b+"','"+n.transactionId+"','"+e+"', '"+n.totalLikes+"', '"+n.customer.Emp_Name+"', '"+n.transactionData.email+"', '"+n.customer.awarded_by_name+"', '"+n.transactionData.awarded_by_email+"', '"+n.transactionData.transactionmethodkey+"','"+a+"','"+t+"','"+f+'\')" id="likeBox_9"><img src="'+v+'" class="likeitbefore">Like '+u+"</a>"+y+'</li><li><a href="javascript:void(0)" class="comment_btn" id="show_comment_box"><img src="/static/img/reply_icon.png">Comment</a></li></ul></div><div class="add_comment" id="addComment_'+e+'" style="'+w+'"><form class="comment_frm" id="commentFrm_'+e+'" name="comment_frm" method="post"><div class="message"></div><input type="hidden" name="csrf_token" value="'+csrf_token+'"><input type="hidden" name="form_index" id="formIndex_'+e+'" value="'+e+'"><input type="hidden" name="transaction_id" id="transactionId_'+e+'" value="'+n.transactionId+'"><input type="hidden" name="comment_receiver_name" id="commentReceiverName_'+e+'" value="'+n.customer.Emp_Name+'"><input type="hidden" name="comment_receiver_email" id="commentReceiverEmail_'+e+'" value="'+n.transactionData.email+'"><input type="hidden" name="comment_awarded_by_name" id="commentAwardedByName_'+e+'" value="'+n.customer.awarded_by_name+'"><input type="hidden" name="comment_awarded_by_email" id="commentAwardedByEmail_'+e+'" value="'+n.transactionData.awarded_by_email+'"><input type="hidden" name="comment_method_type" id="commentMethodType_'+e+'" value="'+n.transactionData.transactionmethodkey+'"><textarea rows="2" name="comment_box" id="commentBox_'+e+'" placeholder="Enter Comment"></textarea><p class="custom_error"></p><div class="post_btn_box"><button type="button" class="cancel_comment" id="cancelComment_'+e+'" onclick="cancel_comment(this,\''+e+'\')">Cancel</button>&nbsp;&nbsp;<button class="submit_comment" type="button" id="submitComment_'+e+'" onclick="submit_post_comment(this,\''+e+'\')">Post</button></div></form></div><div class="comment_list_box"><ul id="tblCommentBox_'+e+'">'+g+"</ul></div></div>"}})),$("#activitySection").html(i),activity_data&&activity_data.length>9?$("#loadMorectivity").show():$("#loadMorectivity").hide(),$(".loaderbox").hide()):($(".loaderbox").hide(),$("#loadMorectivity").hide())}));